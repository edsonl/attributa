import{u as j,h as g,j as G,x as f,c as I,A as L,B as w,k as E,r as N,s as D,i as M,E as U,t as O,v as H}from"./vendor-quasar-DSLrBDx5.js";import{r as d,f as K,w as J,e as W,E as X,F as Y,C as l,O as r,u as Z,N as ee,B as o,K as ae,L as C,M as R,G as le,S as h}from"./vendor-D6jaF0sv.js";const te={class:"tw-space-y-3"},se={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},oe={class:"tw-flex tw-gap-2"},re={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ne={class:"tw-flex tw-items-center tw-gap-2"},ie={class:"text-h6"},ue={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},de={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ce={class:"tw-flex tw-items-center tw-gap-2 tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2"},me={class:"tw-flex tw-gap-6"},pe=400,we={__name:"Index",setup(ve){const B=d([]),m=d(!1),i=d({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),b=d(""),y=d(!1),c=d(!1),n=d({}),p=j();let _=null;const x=()=>({id:null,name:"",slug:"",color_hex:"#6B7280",description:"",is_system:!1,active:!0}),t=d(x()),k=K(()=>!!t.value.id),T=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"slug",label:"Slug",field:"slug",sortable:!0,align:"left"},{name:"color_hex",label:"Cor",field:"color_hex",sortable:!1,align:"left"},{name:"active",label:"Ativo",field:"active",sortable:!0,align:"left"},{name:"is_system",label:"Tipo",field:"is_system",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function P(s){return s?new Date(s).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function v(s){m.value=!0;const{page:a,rowsPerPage:e,sortBy:u,descending:Q}=s.pagination;return h.get(route("panel.campaign-statuses.data"),{params:{page:a,per_page:e,sortBy:u,descending:Q,search:b.value||void 0}}).then(V=>{B.value=V.data.data,i.value={...i.value,page:V.data.current_page,rowsPerPage:V.data.per_page,rowsNumber:V.data.total,sortBy:u,descending:Q}}).finally(()=>{m.value=!1})}function S(s=!1){_&&(clearTimeout(_),_=null);const a=()=>{i.value.page=1,v({pagination:i.value})};s?a():_=setTimeout(a,pe)}function A(){t.value=x(),n.value={},c.value=!0}function q(s){t.value={id:s.id,name:s.name,slug:s.slug,color_hex:s.color_hex||"#6B7280",description:s.description??"",is_system:s.is_system,active:s.active},n.value={},c.value=!0}function $(){c.value=!1,t.value=x(),n.value={}}async function z(){if(y.value)return;y.value=!0,n.value={};const s={...t.value},a=t.value.id?h.put(route("panel.campaign-statuses.update",t.value.id),s):h.post(route("panel.campaign-statuses.store"),s);try{await a,c.value=!1,t.value=x(),p.notify({type:"positive",message:"Dados salvos com sucesso!"}),await v({pagination:i.value})}catch(e){if(e.response?.status===422){n.value=e.response.data.errors||{};const u=e.response.data.message;u&&p.notify({type:"warning",message:u})}else p.notify({type:"negative",message:"Não foi possível salvar o registro."})}finally{y.value=!1}}async function F(s){if(!s?.id)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir status de campanha",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir este status de campanha?")),!!e){m.value=!0;try{await h.delete(route("panel.campaign-statuses.destroy",s.id)),p.notify({type:"positive",message:"Status removido."}),await v({pagination:i.value})}catch(u){p.notify({type:"warning",message:u?.response?.data?.message||"Falha ao remover o status."})}finally{m.value=!1}}}return J(b,()=>{S()}),W(()=>{v({pagination:i.value})}),(s,a)=>(Y(),X(le,null,[l(Z(ee),{title:"Status de Campanha"}),r("div",te,[l(N,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:o(()=>[r("div",se,[r("div",oe,[l(g,{color:"positive",unelevated:"",icon:"add",label:"Novo Status",onClick:A})]),l(G),r("div",re,[l(f,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou slug"},{append:o(()=>[l(I,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>S(!0))})]),_:1},8,["modelValue"])])]),l(L,{rows:B.value,columns:T,"row-key":"id",loading:m.value,pagination:i.value,"onUpdate:pagination":a[2]||(a[2]=e=>i.value=e),"binary-state-sort":!0,onRequest:v},{"body-cell-color_hex":o(e=>[l(w,{props:e},{default:o(()=>[r("div",ne,[r("span",{class:"tw-inline-flex tw-h-3 tw-w-3 tw-rounded-full tw-border tw-border-black/10",style:R({backgroundColor:e.row.color_hex})},null,4),r("span",null,C(e.value),1)])]),_:2},1032,["props"])]),"body-cell-active":o(e=>[l(w,{props:e},{default:o(()=>[l(E,{color:e.row.active?"positive":"grey-6",label:e.row.active_label},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-is_system":o(e=>[l(w,{props:e},{default:o(()=>[l(E,{color:e.row.is_system?"primary":"grey-6",label:e.row.is_system_label},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":o(e=>[l(w,{props:e},{default:o(()=>[ae(C(P(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":o(e=>[l(w,{props:e,class:"tw-text-right"},{default:o(()=>[l(g,{dense:"",flat:"",size:"sm",icon:"edit",class:"qtable-edit-btn",onClick:u=>q(e.row)},null,8,["onClick"]),l(g,{dense:"",flat:"",size:"sm",icon:"delete",class:"qtable-delete-btn",disable:e.row.is_system,onClick:u=>F(e.row)},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(H,{modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=e=>c.value=e),persistent:""},{default:o(()=>[l(N,{class:"tw-w-full tw-max-w-2xl"},{default:o(()=>[l(D,null,{default:o(()=>[r("div",ie,C(k.value?"Editar status":"Novo status"),1)]),_:1}),l(M),l(D,{class:"tw-space-y-3"},{default:o(()=>[r("div",ue,[l(f,{modelValue:t.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.name=e),label:"Nome",dense:"",outlined:"",error:!!n.value.name,"error-message":n.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(f,{modelValue:t.value.slug,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value.slug=e),label:"Slug",dense:"",outlined:"",error:!!n.value.slug,"error-message":n.value.slug?.[0]},null,8,["modelValue","error","error-message"])]),r("div",de,[l(f,{modelValue:t.value.color_hex,"onUpdate:modelValue":a[5]||(a[5]=e=>t.value.color_hex=e),label:"Cor (#RRGGBB)",dense:"",outlined:"",error:!!n.value.color_hex,"error-message":n.value.color_hex?.[0]},null,8,["modelValue","error","error-message"]),r("div",ce,[r("span",{class:"tw-inline-flex tw-h-4 tw-w-4 tw-rounded-full tw-border tw-border-black/10",style:R({backgroundColor:t.value.color_hex||"#6B7280"})},null,4),a[10]||(a[10]=r("span",{class:"tw-text-sm tw-text-gray-600"},"Preview de cor",-1))])]),l(f,{modelValue:t.value.description,"onUpdate:modelValue":a[6]||(a[6]=e=>t.value.description=e),type:"textarea",autogrow:"",label:"Descrição",dense:"",outlined:"",error:!!n.value.description,"error-message":n.value.description?.[0]},null,8,["modelValue","error","error-message"]),r("div",me,[l(U,{modelValue:t.value.active,"onUpdate:modelValue":a[7]||(a[7]=e=>t.value.active=e),label:"Status ativo"},null,8,["modelValue"]),l(U,{modelValue:t.value.is_system,"onUpdate:modelValue":a[8]||(a[8]=e=>t.value.is_system=e),label:"Status de sistema"},null,8,["modelValue"])])]),_:1}),l(O,{align:"right",class:"tw-gap-2 tw-p-4"},{default:o(()=>[l(g,{flat:"",label:"Cancelar",onClick:$}),l(g,{color:"primary",unelevated:"",loading:y.value,label:k.value?"Atualizar":"Cadastrar",onClick:z},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{we as default};
