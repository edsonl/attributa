import{u as j,h as p,j as q,x as C,c as I,A as L,B as x,k as z,r as D,s as N,i as O,F as G,t as H,v as K}from"./vendor-quasar-C0Sd45BE.js";import{r as n,f as M,w as J,e as W,E as X,F as Y,C as l,O as d,u as Z,N as ee,B as s,K as E,L as B,G as ae,S as V}from"./vendor-D6jaF0sv.js";const le={class:"tw-space-y-3"},te={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},oe={class:"tw-flex tw-gap-2"},se={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ie={class:"text-h6"},re={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ne=400,me={__name:"Index",setup(ue){const k=n([]),c=n(!1),r=n({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),v=n(""),f=n(!1),u=n(!1),i=n({}),w=j();let y=null;const b=()=>({id:null,name:"",slug:"",description:"",is_system:!0}),o=n(b()),Q=M(()=>!!o.value.id),T=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"slug",label:"Slug",field:"slug",sortable:!0,align:"left"},{name:"description",label:"Descrição",field:"description",sortable:!1,align:"left"},{name:"is_system",label:"Tipo",field:"is_system",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function U(t){return t?new Date(t).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function m(t){c.value=!0;const{page:a,rowsPerPage:e,sortBy:g,descending:h}=t.pagination;return V.get(route("panel.device-categories.data"),{params:{page:a,per_page:e,sortBy:g,descending:h,search:v.value||void 0}}).then(_=>{k.value=_.data.data,r.value={...r.value,page:_.data.current_page,rowsPerPage:_.data.per_page,rowsNumber:_.data.total,sortBy:g,descending:h}}).finally(()=>{c.value=!1})}function S(t=!1){y&&(clearTimeout(y),y=null);const a=()=>{r.value.page=1,m({pagination:r.value})};t?a():y=setTimeout(a,ne)}function R(){o.value=b(),i.value={},u.value=!0}function P(t){o.value={id:t.id,name:t.name,slug:t.slug,description:t.description??"",is_system:t.is_system},i.value={},u.value=!0}function A(){u.value=!1,o.value=b(),i.value={}}async function F(){if(f.value)return;f.value=!0,i.value={};const t={...o.value},a=o.value.id?V.put(route("panel.device-categories.update",o.value.id),t):V.post(route("panel.device-categories.store"),t);try{await a,u.value=!1,o.value=b(),w.notify({type:"positive",message:"Dados salvos com sucesso!"}),await m({pagination:r.value})}catch(e){e.response?.status===422?i.value=e.response.data.errors||{}:w.notify({type:"negative",message:"Não foi possível salvar o registro."})}finally{f.value=!1}}async function $(t){if(!t)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir categoria de dispositivo",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir esta categoria de dispositivo?")),!!e){c.value=!0;try{await V.delete(route("panel.device-categories.destroy",t)),w.notify({type:"positive",message:"Categoria removida."}),await m({pagination:r.value})}catch{w.notify({type:"negative",message:"Falha ao remover a categoria."})}finally{c.value=!1}}}return J(v,()=>{S()}),W(()=>{m({pagination:r.value})}),(t,a)=>(Y(),X(ae,null,[l(Z(ee),{title:"Categorias de Dispositivo"}),d("div",le,[l(D,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:s(()=>[d("div",te,[d("div",oe,[l(p,{color:"positive",unelevated:"",icon:"add",label:"Nova Categoria",onClick:R})]),l(q),d("div",se,[l(C,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou slug"},{append:s(()=>[l(I,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>S(!0))})]),_:1},8,["modelValue"])])]),l(L,{rows:k.value,columns:T,"row-key":"id",loading:c.value,pagination:r.value,"onUpdate:pagination":a[2]||(a[2]=e=>r.value=e),"binary-state-sort":!0,onRequest:m},{"body-cell-description":s(e=>[l(x,{props:e},{default:s(()=>[E(B(e.value||"-"),1)]),_:2},1032,["props"])]),"body-cell-is_system":s(e=>[l(x,{props:e},{default:s(()=>[l(z,{color:e.row.is_system?"primary":"grey-6",label:e.row.is_system?"Sistema":"Customizado"},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":s(e=>[l(x,{props:e},{default:s(()=>[E(B(U(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":s(e=>[l(x,{props:e,class:"tw-text-right"},{default:s(()=>[l(p,{dense:"",flat:"",icon:"edit",onClick:g=>P(e.row)},null,8,["onClick"]),l(p,{dense:"",flat:"",icon:"delete",color:"negative",onClick:g=>$(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(K,{modelValue:u.value,"onUpdate:modelValue":a[7]||(a[7]=e=>u.value=e),persistent:""},{default:s(()=>[l(D,{class:"tw-w-full tw-max-w-2xl"},{default:s(()=>[l(N,null,{default:s(()=>[d("div",ie,B(Q.value?"Editar categoria":"Nova categoria"),1)]),_:1}),l(O),l(N,{class:"tw-space-y-3"},{default:s(()=>[d("div",re,[l(C,{modelValue:o.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.name=e),label:"Nome",dense:"",outlined:"",error:!!i.value.name,"error-message":i.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(C,{modelValue:o.value.slug,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.slug=e),label:"Slug",dense:"",outlined:"",error:!!i.value.slug,"error-message":i.value.slug?.[0]},null,8,["modelValue","error","error-message"])]),l(C,{modelValue:o.value.description,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.description=e),type:"textarea",autogrow:"",label:"Descrição",dense:"",outlined:"",error:!!i.value.description,"error-message":i.value.description?.[0]},null,8,["modelValue","error","error-message"]),l(G,{modelValue:o.value.is_system,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.is_system=e),label:"Categoria de sistema"},null,8,["modelValue"])]),_:1}),l(H,{align:"right",class:"tw-gap-2 tw-p-4"},{default:s(()=>[l(p,{flat:"",label:"Cancelar",onClick:A}),l(p,{color:"primary",unelevated:"",loading:f.value,label:Q.value?"Atualizar":"Cadastrar",onClick:F},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{me as default};
