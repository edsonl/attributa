import{u as L,h as g,j as R,x as d,c as q,A as M,B as C,k as G,r as z,s as U,i as H,F as J,t as K,v as W}from"./vendor-quasar-C0Sd45BE.js";import{r as u,f as X,w as Y,e as Z,E,F as D,C as l,O as i,u as ee,N as ae,B as n,K as le,L as B,J as te,G as oe,S as x}from"./vendor-D6jaF0sv.js";const re={class:"tw-space-y-3"},ne={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},se={class:"tw-flex tw-gap-2"},ue={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ie={class:"tw-flex tw-items-center tw-gap-2"},de=["src","alt"],ce={class:"text-h6"},me={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ve=400,we={__name:"Index",setup(fe){const S=u([]),v=u(!1),s=u({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),p=u(""),w=u(!1),c=u(!1),r=u({}),y=L();let b=null;const _=()=>({id:null,iso2:"",iso3:"",name:"",currency:"",currency_symbol:"",timezone_default:"",active:!0}),o=u(_()),k=X(()=>!!o.value.id),I="https://attributa.master.dev.br".replace(/\/$/,""),P=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"iso2",label:"ISO2",field:"iso2",sortable:!0,align:"left"},{name:"iso3",label:"ISO3",field:"iso3",sortable:!0,align:"left"},{name:"currency",label:"Moeda",field:"currency",sortable:!0,align:"left"},{name:"currency_symbol",label:"Símbolo",field:"currency_symbol",sortable:!0,align:"left"},{name:"timezone_default",label:"Timezone",field:"timezone_default",sortable:!0,align:"left"},{name:"active",label:"Status",field:"active",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function T(t){return t?new Date(t).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function h(t){const a=t?.iso2;if(!a)return null;const e=String(a).toLowerCase();return`${I||""}/assets/country-flags/${e}.svg`}function f(t){v.value=!0;const{page:a,rowsPerPage:e,sortBy:m,descending:N}=t.pagination;return x.get(route("panel.countries.data"),{params:{page:a,per_page:e,sortBy:m,descending:N,search:p.value||void 0}}).then(V=>{S.value=V.data.data,s.value={...s.value,page:V.data.current_page,rowsPerPage:V.data.per_page,rowsNumber:V.data.total,sortBy:m,descending:N}}).finally(()=>{v.value=!1})}function Q(t=!1){b&&(clearTimeout(b),b=null);const a=()=>{s.value.page=1,f({pagination:s.value})};t?a():b=setTimeout(a,ve)}function $(){o.value=_(),r.value={},c.value=!0}function A(t){o.value={id:t.id,iso2:t.iso2,iso3:t.iso3,name:t.name,currency:t.currency,currency_symbol:t.currency_symbol,timezone_default:t.timezone_default,active:t.active},r.value={},c.value=!0}function O(){c.value=!1,o.value=_(),r.value={}}async function F(){if(w.value)return;w.value=!0,r.value={};const t={...o.value},a=o.value.id?x.put(route("panel.countries.update",o.value.id),t):x.post(route("panel.countries.store"),t);try{await a,c.value=!1,o.value=_(),y.notify({type:"positive",message:"Dados salvos com sucesso!"}),await f({pagination:s.value})}catch(e){e.response?.status===422?r.value=e.response.data.errors||{}:y.notify({type:"negative",message:"Não foi possível salvar o país."})}finally{w.value=!1}}async function j(t){if(!t)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir país",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir este país?")),!!e){v.value=!0;try{await x.delete(route("panel.countries.destroy",t)),y.notify({type:"positive",message:"País removido."}),await f({pagination:s.value})}catch{y.notify({type:"negative",message:"Falha ao remover o país."})}finally{v.value=!1}}}return Y(p,()=>{Q()}),Z(()=>{f({pagination:s.value})}),(t,a)=>(D(),E(oe,null,[l(ee(ae),{title:"Países"}),i("div",re,[l(z,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:n(()=>[i("div",ne,[i("div",se,[l(g,{color:"positive",unelevated:"",icon:"add",label:"Novo País",onClick:$})]),l(R),i("div",ue,[l(d,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou código"},{append:n(()=>[l(q,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>Q(!0))})]),_:1},8,["modelValue"])])]),l(M,{rows:S.value,columns:P,"row-key":"id",loading:v.value,pagination:s.value,"onUpdate:pagination":a[2]||(a[2]=e=>s.value=e),"binary-state-sort":!0,onRequest:f},{"body-cell-name":n(e=>[l(C,{props:e},{default:n(()=>[i("div",ie,[h(e.row)?(D(),E("img",{key:0,src:h(e.row),alt:e.row.iso2,class:"tw-w-6 tw-h-4 tw-rounded-sm tw-object-cover tw-border tw-border-gray-200"},null,8,de)):te("",!0),i("span",null,B(e.value||"-"),1)])]),_:2},1032,["props"])]),"body-cell-active":n(e=>[l(C,{props:e},{default:n(()=>[l(G,{color:e.row.active?"positive":"grey-5",label:e.row.active?"Ativo":"Inativo"},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":n(e=>[l(C,{props:e},{default:n(()=>[le(B(T(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[l(C,{props:e,class:"tw-text-right"},{default:n(()=>[l(g,{dense:"",flat:"",icon:"edit",onClick:m=>A(e.row)},null,8,["onClick"]),l(g,{dense:"",flat:"",icon:"delete",color:"negative",onClick:m=>j(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(W,{modelValue:c.value,"onUpdate:modelValue":a[10]||(a[10]=e=>c.value=e),persistent:""},{default:n(()=>[l(z,{class:"tw-w-full tw-max-w-2xl"},{default:n(()=>[l(U,null,{default:n(()=>[i("div",ce,B(k.value?"Editar país":"Novo país"),1)]),_:1}),l(H),l(U,{class:"tw-space-y-3"},{default:n(()=>[i("div",me,[l(d,{modelValue:o.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.name=e),label:"Nome",dense:"",outlined:"",error:!!r.value.name,"error-message":r.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(d,{modelValue:o.value.iso2,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.iso2=e),label:"ISO2",dense:"",outlined:"",maxlength:"2",error:!!r.value.iso2,"error-message":r.value.iso2?.[0]},null,8,["modelValue","error","error-message"]),l(d,{modelValue:o.value.iso3,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.iso3=e),label:"ISO3",dense:"",outlined:"",maxlength:"3",error:!!r.value.iso3,"error-message":r.value.iso3?.[0]},null,8,["modelValue","error","error-message"]),l(d,{modelValue:o.value.currency,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.currency=e),label:"Moeda (ISO 4217)",dense:"",outlined:"",maxlength:"3",error:!!r.value.currency,"error-message":r.value.currency?.[0]},null,8,["modelValue","error","error-message"]),l(d,{modelValue:o.value.currency_symbol,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value.currency_symbol=e),label:"Símbolo da moeda",dense:"",outlined:"",maxlength:"5",error:!!r.value.currency_symbol,"error-message":r.value.currency_symbol?.[0]},null,8,["modelValue","error","error-message"]),l(d,{modelValue:o.value.timezone_default,"onUpdate:modelValue":a[8]||(a[8]=e=>o.value.timezone_default=e),label:"Timezone padrão",dense:"",outlined:"",error:!!r.value.timezone_default,"error-message":r.value.timezone_default?.[0]},null,8,["modelValue","error","error-message"])]),l(J,{modelValue:o.value.active,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value.active=e),label:"Ativo"},null,8,["modelValue"])]),_:1}),l(K,{align:"right",class:"tw-gap-2 tw-p-4"},{default:n(()=>[l(g,{flat:"",label:"Cancelar",onClick:O}),l(g,{color:"primary",unelevated:"",loading:w.value,label:k.value?"Atualizar":"Cadastrar",onClick:F},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{we as default};
