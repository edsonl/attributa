import{u as O,h as p,j as $,x as i,c as M,A as R,B as C,k as j,r as z,s as E,i as q,E as F,t as H,v as L}from"./vendor-quasar-CLzIisyG.js";import{r as u,f as G,w as J,e as K,G as W,H as X,E as l,Q as m,u as Y,P as Z,D as n,M as ee,N,I as ae,V as x}from"./vendor-D8nj3W7R.js";const le={class:"tw-space-y-3"},oe={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},te={class:"tw-flex tw-gap-2"},re={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ne={class:"text-h6"},se={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ue=400,ce={__name:"Index",setup(ie){const B=u([]),c=u(!1),s=u({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),g=u(""),y=u(!1),d=u(!1),r=u({}),w=O();let b=null;const _=()=>({id:null,iso2:"",iso3:"",name:"",currency:"",currency_symbol:"",timezone_default:"",active:!0}),o=u(_()),S=G(()=>!!o.value.id),U=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"iso2",label:"ISO2",field:"iso2",sortable:!0,align:"left"},{name:"iso3",label:"ISO3",field:"iso3",sortable:!0,align:"left"},{name:"currency",label:"Moeda",field:"currency",sortable:!0,align:"left"},{name:"currency_symbol",label:"Símbolo",field:"currency_symbol",sortable:!0,align:"left"},{name:"timezone_default",label:"Timezone",field:"timezone_default",sortable:!0,align:"left"},{name:"active",label:"Status",field:"active",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function h(t){return t?new Date(t).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function v(t){c.value=!0;const{page:a,rowsPerPage:e,sortBy:f,descending:k}=t.pagination;return x.get(route("panel.countries.data"),{params:{page:a,per_page:e,sortBy:f,descending:k,search:g.value||void 0}}).then(V=>{B.value=V.data.data,s.value={...s.value,page:V.data.current_page,rowsPerPage:V.data.per_page,rowsNumber:V.data.total,sortBy:f,descending:k}}).finally(()=>{c.value=!1})}function Q(t=!1){b&&(clearTimeout(b),b=null);const a=()=>{s.value.page=1,v({pagination:s.value})};t?a():b=setTimeout(a,ue)}function D(){o.value=_(),r.value={},d.value=!0}function I(t){o.value={id:t.id,iso2:t.iso2,iso3:t.iso3,name:t.name,currency:t.currency,currency_symbol:t.currency_symbol,timezone_default:t.timezone_default,active:t.active},r.value={},d.value=!0}function P(){d.value=!1,o.value=_(),r.value={}}async function T(){if(y.value)return;y.value=!0,r.value={};const t={...o.value},a=o.value.id?x.put(route("panel.countries.update",o.value.id),t):x.post(route("panel.countries.store"),t);try{await a,d.value=!1,o.value=_(),w.notify({type:"positive",message:"Dados salvos com sucesso!"}),await v({pagination:s.value})}catch(e){e.response?.status===422?r.value=e.response.data.errors||{}:w.notify({type:"negative",message:"Não foi possível salvar o país."})}finally{y.value=!1}}async function A(t){if(!t)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir país",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir este país?")),!!e){c.value=!0;try{await x.delete(route("panel.countries.destroy",t)),w.notify({type:"positive",message:"País removido."}),await v({pagination:s.value})}catch{w.notify({type:"negative",message:"Falha ao remover o país."})}finally{c.value=!1}}}return J(g,()=>{Q()}),K(()=>{v({pagination:s.value})}),(t,a)=>(X(),W(ae,null,[l(Y(Z),{title:"Países"}),m("div",le,[l(z,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:n(()=>[m("div",oe,[m("div",te,[l(p,{color:"positive",unelevated:"",icon:"add",label:"Novo País",onClick:D})]),l($),m("div",re,[l(i,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=e=>g.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou código"},{append:n(()=>[l(M,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>Q(!0))})]),_:1},8,["modelValue"])])]),l(R,{rows:B.value,columns:U,"row-key":"id",loading:c.value,pagination:s.value,"onUpdate:pagination":a[2]||(a[2]=e=>s.value=e),"binary-state-sort":!0,onRequest:v},{"body-cell-active":n(e=>[l(C,{props:e},{default:n(()=>[l(j,{color:e.row.active?"positive":"grey-5",label:e.row.active?"Ativo":"Inativo"},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":n(e=>[l(C,{props:e},{default:n(()=>[ee(N(h(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[l(C,{props:e,class:"tw-text-right"},{default:n(()=>[l(p,{dense:"",flat:"",icon:"edit",onClick:f=>I(e.row)},null,8,["onClick"]),l(p,{dense:"",flat:"",icon:"delete",color:"negative",onClick:f=>A(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(L,{modelValue:d.value,"onUpdate:modelValue":a[10]||(a[10]=e=>d.value=e),persistent:""},{default:n(()=>[l(z,{class:"tw-w-full tw-max-w-2xl"},{default:n(()=>[l(E,null,{default:n(()=>[m("div",ne,N(S.value?"Editar país":"Novo país"),1)]),_:1}),l(q),l(E,{class:"tw-space-y-3"},{default:n(()=>[m("div",se,[l(i,{modelValue:o.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.name=e),label:"Nome",dense:"",outlined:"",error:!!r.value.name,"error-message":r.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(i,{modelValue:o.value.iso2,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.iso2=e),label:"ISO2",dense:"",outlined:"",maxlength:"2",error:!!r.value.iso2,"error-message":r.value.iso2?.[0]},null,8,["modelValue","error","error-message"]),l(i,{modelValue:o.value.iso3,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.iso3=e),label:"ISO3",dense:"",outlined:"",maxlength:"3",error:!!r.value.iso3,"error-message":r.value.iso3?.[0]},null,8,["modelValue","error","error-message"]),l(i,{modelValue:o.value.currency,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.currency=e),label:"Moeda (ISO 4217)",dense:"",outlined:"",maxlength:"3",error:!!r.value.currency,"error-message":r.value.currency?.[0]},null,8,["modelValue","error","error-message"]),l(i,{modelValue:o.value.currency_symbol,"onUpdate:modelValue":a[7]||(a[7]=e=>o.value.currency_symbol=e),label:"Símbolo da moeda",dense:"",outlined:"",maxlength:"5",error:!!r.value.currency_symbol,"error-message":r.value.currency_symbol?.[0]},null,8,["modelValue","error","error-message"]),l(i,{modelValue:o.value.timezone_default,"onUpdate:modelValue":a[8]||(a[8]=e=>o.value.timezone_default=e),label:"Timezone padrão",dense:"",outlined:"",error:!!r.value.timezone_default,"error-message":r.value.timezone_default?.[0]},null,8,["modelValue","error","error-message"])]),l(F,{modelValue:o.value.active,"onUpdate:modelValue":a[9]||(a[9]=e=>o.value.active=e),label:"Ativo"},null,8,["modelValue"])]),_:1}),l(H,{align:"right",class:"tw-gap-2 tw-p-4"},{default:n(()=>[l(p,{flat:"",label:"Cancelar",onClick:P}),l(p,{color:"primary",unelevated:"",loading:y.value,label:S.value?"Atualizar":"Cadastrar",onClick:T},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ce as default};
