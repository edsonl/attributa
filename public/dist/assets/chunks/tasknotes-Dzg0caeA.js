import{u as E,k as C,h as c,x as n,E as V,K as S,r as F,s as L,t as P,F as R,v as T}from"./vendor-quasar-C0NOBKaR.js";import{r as w,e as j,G as m,H as i,C as x,E as a,D as p,Q as d,I as N,J as H,L as k,N as y,M as U,j as q}from"./vendor-CkK7ip2Q.js";const G={class:"tw-mt-4"},J={key:0,class:"tw-bg-gray-50 tw-border tw-rounded-lg tw-p-3 tw-text-sm tw-text-gray-600"},K={class:"tw-space-y-3"},O={class:"tw-flex tw-justify-between tw-items-center"},W={class:"tw-flex tw-items-center"},X={class:"tw-text-xs tw-text-gray-500"},Y={key:0,class:"tw-ms-2"},Z={key:1,class:"tw-ms-2"},ee={class:"tw-flex tw-gap-2 tw-justify-end"},te={class:"tw-flex tw-w-full"},le={class:"tw-text-gray-600"},ae={class:"tw-bg-white tw-border tw-rounded-lg tw-p-3"},oe={class:"tw-grid tw-grid-cols-3 tw-gap-2 tw-mt-2"},se={class:"tw-grid tw-grid-cols-2 tw-gap-2"},de={class:"tw-flex tw-mt-2"},ne={class:"tw-text-right tw-mt-2"},ie={class:"tw-grid tw-grid-cols-3 tw-gap-2 tw-mt-2"},ue={class:"tw-grid tw-grid-cols-2 tw-gap-2"},re={class:"tw-flex tw-mt-2"},ve={__name:"TaskNotes",props:{taskId:Number},setup(_){const u=_,v=E(),r=w([]),o=w({description:"",date:"",time_hours:null,time_minutes:null,value:null,paid:!1,done:!1}),f=w(!1),b=w(null),s=w({description:"",date:"",time_hours:null,time_minutes:null,value:null,paid:!1,done:!1});function D(l){return l?new Date(l).toLocaleString("pt-BR"):""}function h(l){const t=Math.floor(l/60),e=l%60;return`${t}h ${e}m`}function I(l){const t=Number(l);return isNaN(t)?"":t.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}const Q=()=>{u.taskId&&axios.get(route("panel.tasks.notes.index",u.taskId)).then(l=>r.value=l.data).catch(()=>{})},M=()=>{if(!o.value.description){v.notify({type:"warning",message:"DescriÃ§Ã£o Ã© obrigatÃ³ria."});return}axios.post(route("panel.tasks.notes.store",u.taskId),{...o.value,paid:o.value.paid?1:0}).then(l=>{r.value.unshift(l.data.note),o.value={description:"",date:"",time_hours:null,time_minutes:null,value:null,paid:!1,done:!1},v.notify({type:"positive",message:"AnotaÃ§Ã£o adicionada."})})},B=l=>{l.done=!l.done,axios.put(route("panel.tasks.notes.update",[u.taskId,l.id]),{...l,done:l.done?1:0}).then(t=>{v.notify({type:"positive",message:"AnotaÃ§Ã£o atualizada."})})},$=l=>{v.dialog({title:"Excluir",message:"Deseja remover esta anotaÃ§Ã£o?",cancel:!0,persistent:!0}).onOk(()=>{axios.delete(route("panel.tasks.notes.destroy",[u.taskId,l])).then(()=>{r.value=r.value.filter(t=>t.id!==l),v.notify({type:"positive",message:"AnotaÃ§Ã£o excluÃ­da."})})})},z=l=>{b.value=l,s.value={description:l.description,date:l.date?l.date.slice(0,16):"",time_hours:l.time_minutes?Math.floor(l.time_minutes/60):null,time_minutes:l.time_minutes?l.time_minutes%60:null,value:l.value??null,paid:!!l.paid,done:!!l.done},f.value=!0},A=()=>{b.value&&axios.put(route("panel.tasks.notes.update",[u.taskId,b.value.id]),{...s.value,paid:s.value.paid?1:0,done:s.value.done?1:0}).then(l=>{const t=l.data.note,e=r.value.findIndex(g=>g.id===t.id);e!==-1&&(r.value[e]=t),f.value=!1,v.notify({type:"positive",message:"AnotaÃ§Ã£o atualizada."})})};return j(()=>{u.taskId&&Q()}),(l,t)=>(i(),m("div",G,[_.taskId?(i(),x(S,{key:1,icon:"chat",label:"AnotaÃ§Ãµes","expand-separator":""},{default:p(()=>[d("div",K,[(i(!0),m(N,null,H(r.value,e=>(i(),m("div",{key:e.id,class:"tw-bg-gray-50 tw-rounded-lg tw-p-3 tw-flex tw-flex-col tw-gap-1"},[d("div",O,[d("div",W,[d("span",X,y(D(e.date)),1),e.time_minutes?(i(),m("span",Y,"Tempo: "+y(h(e.time_minutes)),1)):k("",!0),e.value?(i(),m("span",Z,y(I(e.value)),1)):k("",!0),e.value>0?(i(),m(N,{key:2},[e.paid?(i(),x(C,{key:0,color:"positive",class:"tw-ms-2"},{default:p(()=>[...t[15]||(t[15]=[U(" Pago ",-1)])]),_:1})):(i(),x(C,{key:1,color:"orange",class:"tw-ms-2"},{default:p(()=>[...t[16]||(t[16]=[U(" Pendente ",-1)])]),_:1}))],64)):k("",!0)]),d("div",ee,[a(c,{flat:"",size:"sm",icon:"check_circle",round:"",onClick:g=>B(e),color:`${e.done?"positive":"warning"}`},null,8,["onClick","color"]),a(c,{flat:"",size:"sm",color:"primary",icon:"edit",round:"",onClick:g=>z(e)},null,8,["onClick"]),a(c,{flat:"",size:"sm",color:"negative",icon:"delete",round:"",onClick:g=>$(e.id)},null,8,["onClick"])])]),d("div",te,[d("p",le,y(e.description),1)])]))),128)),d("div",ae,[a(n,{modelValue:o.value.description,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value.description=e),label:"DescriÃ§Ã£o",dense:"",maxlength:"255",type:"textarea",autogrow:""},null,8,["modelValue"]),d("div",oe,[a(n,{modelValue:o.value.date,"onUpdate:modelValue":t[1]||(t[1]=e=>o.value.date=e),type:"datetime-local",label:"Data",dense:""},null,8,["modelValue"]),d("div",se,[a(n,{modelValue:o.value.time_hours,"onUpdate:modelValue":t[2]||(t[2]=e=>o.value.time_hours=e),modelModifiers:{number:!0},type:"number",min:"0",label:"Horas",dense:""},null,8,["modelValue"]),a(n,{modelValue:o.value.time_minutes,"onUpdate:modelValue":t[3]||(t[3]=e=>o.value.time_minutes=e),modelModifiers:{number:!0},type:"number",min:"0",max:"59",label:"Minutos",dense:""},null,8,["modelValue"])]),a(n,{modelValue:o.value.value,"onUpdate:modelValue":t[4]||(t[4]=e=>o.value.value=e),type:"number",step:"0.01",label:"Valor (R$)",dense:""},null,8,["modelValue"])]),d("div",de,[a(V,{modelValue:o.value.paid,"onUpdate:modelValue":t[5]||(t[5]=e=>o.value.paid=e),label:"Pago?",color:"green","left-label":""},null,8,["modelValue"]),a(V,{modelValue:o.value.done,"onUpdate:modelValue":t[6]||(t[6]=e=>o.value.done=e),label:"Finalizado?",color:"green","left-label":""},null,8,["modelValue"])]),d("div",ne,[a(c,{color:"primary",icon:"add",label:"Adicionar",size:"sm",onClick:M})])])])]),_:1})):(i(),m("div",J," ðŸ’¡ Salve a tarefa para adicionar anotaÃ§Ãµes. ")),a(T,{modelValue:f.value,"onUpdate:modelValue":t[14]||(t[14]=e=>f.value=e)},{default:p(()=>[a(F,{class:"tw-w-[500px] max-w-full"},{default:p(()=>[a(L,null,{default:p(()=>[t[17]||(t[17]=d("div",{class:"tw-font-semibold tw-text-lg tw-mb-2"},"Editar anotaÃ§Ã£o",-1)),a(n,{modelValue:s.value.description,"onUpdate:modelValue":t[7]||(t[7]=e=>s.value.description=e),label:"DescriÃ§Ã£o",dense:"",maxlength:"255",type:"textarea",autogrow:""},null,8,["modelValue"]),d("div",ie,[a(n,{modelValue:s.value.date,"onUpdate:modelValue":t[8]||(t[8]=e=>s.value.date=e),type:"datetime-local",label:"Data",dense:""},null,8,["modelValue"]),d("div",ue,[a(n,{modelValue:s.value.time_hours,"onUpdate:modelValue":t[9]||(t[9]=e=>s.value.time_hours=e),modelModifiers:{number:!0},type:"number",min:"0",label:"Horas",dense:""},null,8,["modelValue"]),a(n,{modelValue:s.value.time_minutes,"onUpdate:modelValue":t[10]||(t[10]=e=>s.value.time_minutes=e),modelModifiers:{number:!0},type:"number",min:"0",max:"59",label:"Minutos",dense:""},null,8,["modelValue"])]),a(n,{modelValue:s.value.value,"onUpdate:modelValue":t[11]||(t[11]=e=>s.value.value=e),type:"number",step:"0.01",label:"Valor (R$)",dense:""},null,8,["modelValue"])]),d("div",re,[a(V,{modelValue:s.value.paid,"onUpdate:modelValue":t[12]||(t[12]=e=>s.value.paid=e),label:"Pago?",color:"green","left-label":""},null,8,["modelValue"]),a(V,{modelValue:s.value.done,"onUpdate:modelValue":t[13]||(t[13]=e=>s.value.done=e),label:"Finalizado?",color:"green","left-label":""},null,8,["modelValue"])])]),_:1}),a(P,{align:"right"},{default:p(()=>[q(a(c,{flat:"",label:"Cancelar"},null,512),[[R]]),a(c,{color:"primary",label:"Salvar",onClick:A})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ve as default};
