import{u as $,e as p,m as z,A as x,c as F,F as j,G as V,n as G,v as D,w as h,l as H,I as L,x as O,y as M}from"./vendor-quasar-Bee0Lbku.js";import{r as i,f as J,w as K,e as W,G as X,H as Y,E as l,Q as d,u as Z,S as ee,D as s,N as E,O as N,I as ae,R as C}from"./vendor-BB0I-wvh.js";const le={class:"tw-space-y-3"},te={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},oe={class:"tw-flex tw-gap-2"},se={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ne={class:"text-h6"},re={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ie=400,ce={__name:"Index",setup(ue){const Q=i([]),m=i(!1),r=i({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),v=i(""),f=i(!1),u=i(!1),n=i({}),w=$();let y=null;const b=()=>({id:null,name:"",slug:"",description:"",is_system:!0}),o=i(b()),B=J(()=>!!o.value.id),R=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"slug",label:"Slug",field:"slug",sortable:!0,align:"left"},{name:"description",label:"Descrição",field:"description",sortable:!1,align:"left"},{name:"is_system",label:"Tipo",field:"is_system",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function T(t){return t?new Date(t).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function c(t){m.value=!0;const{page:a,rowsPerPage:e,sortBy:g,descending:S}=t.pagination;return C.get(route("panel.browsers.data"),{params:{page:a,per_page:e,sortBy:g,descending:S,search:v.value||void 0}}).then(_=>{Q.value=_.data.data,r.value={...r.value,page:_.data.current_page,rowsPerPage:_.data.per_page,rowsNumber:_.data.total,sortBy:g,descending:S}}).finally(()=>{m.value=!1})}function k(t=!1){y&&(clearTimeout(y),y=null);const a=()=>{r.value.page=1,c({pagination:r.value})};t?a():y=setTimeout(a,ie)}function U(){o.value=b(),n.value={},u.value=!0}function P(t){o.value={id:t.id,name:t.name,slug:t.slug,description:t.description??"",is_system:t.is_system},n.value={},u.value=!0}function q(){u.value=!1,o.value=b(),n.value={}}async function A(){if(f.value)return;f.value=!0,n.value={};const t={...o.value},a=o.value.id?C.put(route("panel.browsers.update",o.value.id),t):C.post(route("panel.browsers.store"),t);try{await a,u.value=!1,o.value=b(),w.notify({type:"positive",message:"Dados salvos com sucesso!"}),await c({pagination:r.value})}catch(e){e.response?.status===422?n.value=e.response.data.errors||{}:w.notify({type:"negative",message:"Não foi possível salvar o registro."})}finally{f.value=!1}}async function I(t){if(!t)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir navegador",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir este navegador?")),!!e){m.value=!0;try{await C.delete(route("panel.browsers.destroy",t)),w.notify({type:"positive",message:"Navegador removido."}),await c({pagination:r.value})}catch{w.notify({type:"negative",message:"Falha ao remover o navegador."})}finally{m.value=!1}}}return K(v,()=>{k()}),W(()=>{c({pagination:r.value})}),(t,a)=>(Y(),X(ae,null,[l(Z(ee),{title:"Navegadores"}),d("div",le,[l(D,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:s(()=>[d("div",te,[d("div",oe,[l(p,{color:"positive",unelevated:"",icon:"add",label:"Novo Navegador",onClick:U})]),l(z),d("div",se,[l(x,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou slug"},{append:s(()=>[l(F,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>k(!0))})]),_:1},8,["modelValue"])])]),l(j,{rows:Q.value,columns:R,"row-key":"id",loading:m.value,pagination:r.value,"onUpdate:pagination":a[2]||(a[2]=e=>r.value=e),"binary-state-sort":!0,onRequest:c},{"body-cell-description":s(e=>[l(V,{props:e},{default:s(()=>[E(N(e.value||"-"),1)]),_:2},1032,["props"])]),"body-cell-is_system":s(e=>[l(V,{props:e},{default:s(()=>[l(G,{color:e.row.is_system?"primary":"grey-6",label:e.row.is_system?"Sistema":"Customizado"},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":s(e=>[l(V,{props:e},{default:s(()=>[E(N(T(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":s(e=>[l(V,{props:e,class:"tw-text-right"},{default:s(()=>[l(p,{dense:"",flat:"",size:"sm",icon:"edit",class:"qtable-edit-btn",onClick:g=>P(e.row)},null,8,["onClick"]),l(p,{dense:"",flat:"",size:"sm",icon:"delete",class:"qtable-delete-btn",onClick:g=>I(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(M,{modelValue:u.value,"onUpdate:modelValue":a[7]||(a[7]=e=>u.value=e),persistent:""},{default:s(()=>[l(D,{class:"tw-w-full tw-max-w-2xl"},{default:s(()=>[l(h,null,{default:s(()=>[d("div",ne,N(B.value?"Editar navegador":"Novo navegador"),1)]),_:1}),l(H),l(h,{class:"tw-space-y-3"},{default:s(()=>[d("div",re,[l(x,{modelValue:o.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>o.value.name=e),label:"Nome",dense:"",outlined:"",error:!!n.value.name,"error-message":n.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(x,{modelValue:o.value.slug,"onUpdate:modelValue":a[4]||(a[4]=e=>o.value.slug=e),label:"Slug",dense:"",outlined:"",error:!!n.value.slug,"error-message":n.value.slug?.[0]},null,8,["modelValue","error","error-message"])]),l(x,{modelValue:o.value.description,"onUpdate:modelValue":a[5]||(a[5]=e=>o.value.description=e),type:"textarea",autogrow:"",label:"Descrição",dense:"",outlined:"",error:!!n.value.description,"error-message":n.value.description?.[0]},null,8,["modelValue","error","error-message"]),l(L,{modelValue:o.value.is_system,"onUpdate:modelValue":a[6]||(a[6]=e=>o.value.is_system=e),label:"Categoria de sistema"},null,8,["modelValue"])]),_:1}),l(O,{align:"right",class:"tw-gap-2 tw-p-4"},{default:s(()=>[l(p,{flat:"",label:"Cancelar",onClick:q}),l(p,{color:"primary",unelevated:"",loading:f.value,label:B.value?"Atualizar":"Cadastrar",onClick:A},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{ce as default};
