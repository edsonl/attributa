import{u as Ce,r as Se,s as W,h as w,I as he,n as k,L as $e,M as Ne,v as Le}from"./vendor-quasar-DQshVSCQ.js";import{_ as Re}from"../app-D66qIGEV.js";import{f as o,A as f,F as r,B as d,C as v,J as p,P as t,M as a,L as C,u as Ve,E as _,G as R,H as V,N as Pe}from"./vendor-auwb9AcH.js";const De={class:"detail-section first-row-section"},Ie={class:"section-card"},xe={class:"section-card__body"},ze={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-3 tw-gap-4"},Ee={class:"detail-value"},Oe={class:"detail-value"},Be={class:"value-with-copy value-with-copy--inline"},Te={class:"detail-value"},Ue={class:"value-with-copy value-with-copy--inline"},Ae={class:"truncated-preview"},Fe={class:"value-with-copy value-with-copy--inline"},Ge={class:"truncated-preview"},Me={class:"detail-value"},Qe={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-3 tw-gap-4"},qe={class:"detail-value tw-flex tw-items-center tw-gap-2"},je=["src","alt"],We={class:"detail-label"},He={class:"detail-value"},Je={class:"detail-section first-row-section"},Ke={class:"section-card"},Ze={class:"section-card__body"},Xe={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-3 tw-gap-4"},Ye={class:"detail-value"},et={class:"detail-value"},tt={class:"detail-value"},lt={class:"detail-value"},it={class:"detail-value"},at={class:"detail-value"},ot={class:"detail-value"},st={class:"detail-value"},nt={class:"detail-value"},rt={class:"detail-value"},dt={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-4 tw-gap-4"},ut={class:"detail-value"},ct={class:"detail-value"},vt={class:"tw-mt-1"},mt={class:"ip-category-description"},ft={class:"detail-value"},pt={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-4 tw-gap-3 tw-mt-4"},_t={class:"detail-label"},gt={class:"detail-value"},yt={class:"detail-section xl:tw-col-span-2"},wt={class:"section-card"},bt={class:"section-card__body section-body--compact"},kt={class:"tw-grid md:tw-grid-cols-2 lg:tw-grid-cols-4 tw-gap-3"},Ct={class:"detail-value"},St={class:"detail-value"},ht={class:"detail-value"},$t={class:"value-with-copy"},Nt={class:"detail-value tw-break-all"},Lt={class:"lg:tw-col-span-2"},Rt={class:"value-with-copy"},Vt={class:"detail-value tw-break-all"},Pt={class:"lg:tw-col-span-2"},Dt={class:"detail-value tw-break-all"},It={class:"lg:tw-col-span-4"},xt={key:0,class:"url-params-inline"},zt={class:"url-param-key"},Et={class:"value-with-copy value-with-copy--inline"},Ot={class:"truncated-preview"},Bt={key:1,class:"traffic-empty"},H=20,Tt={__name:"PageviewDetailModal",props:{modelValue:{type:Boolean,required:!0},loading:{type:Boolean,default:!1},payload:{type:Object,default:()=>null},assetBaseUrl:{type:String,default:""}},emits:["update:modelValue"],setup(P,{emit:J}){const K=[{label:"Código",key:"country_code"},{label:"Região",key:"region_name"},{label:"Cidade",key:"city"},{label:"Latitude",key:"latitude"},{label:"Longitude",key:"longitude"},{label:"Timezone",key:"timezone"}],Z=[{key:"is_proxy",label:"Proxy"},{key:"is_vpn",label:"VPN"},{key:"is_tor",label:"Tor"},{key:"is_datacenter",label:"Datacenter"},{key:"is_bot",label:"Bot"}],m=P,X=J,D=Ce(),I=o({get:()=>m.modelValue,set:l=>X("update:modelValue",l)}),s=o(()=>m.payload?.pageview??{}),x=o(()=>m.payload?.url??{full:null,origin:null,path:null,query_params:{}}),h=o(()=>m.payload?.geo??{}),S=o(()=>m.payload?.network??{}),Y=o(()=>s.value?.campaign?.name??"-"),ee=o(()=>S.value?.flags??{}),z=o(()=>S.value?.ip_category??null),te=o(()=>z.value?.color_hex??"#475569"),le=o(()=>z.value?.name??"-"),ie=o(()=>z.value?.description??"Sem descrição."),ae=o(()=>s.value?.traffic_source_category??null),A=o(()=>ae.value?.name??"Não classificado"),oe=o(()=>ye(s.value?.traffic_source_reason)),F=o(()=>{const l=h.value?.country_code;return l?`${m.assetBaseUrl}/assets/country-flags/${String(l).toLowerCase()}.svg`:null}),se=o(()=>Q(x.value?.full||"")),E=o(()=>s.value?.landing_url??null),ne=o(()=>Q(E.value||"")),$=o(()=>s.value?.referrer??null),re=o(()=>pe($.value)),O=o(()=>ge()),B=o(()=>m.payload?.composed_code??null),de=o(()=>Array.isArray(m.payload?.events)?m.payload.events:[]),G=o(()=>{const l=x.value?.query_params??{};return Object.entries(l)}),ue=o(()=>G.value.length>0),T=o(()=>{const l={page_engaged:{first:null,count:0},form_submit:{first:null,count:0},link_click:{first:null,count:0}};return de.value.forEach(e=>{const i=String(e?.event_type||"").toLowerCase();Object.prototype.hasOwnProperty.call(l,i)&&(l[i].first||(l[i].first=e),l[i].count+=1)}),l}),M=o(()=>{const l=T.value.page_engaged,e=T.value.form_submit,i=T.value.link_click,n=!!e.first,c=n?e:i,N=s.value?.created_at_formatted||"Não identificado",we=l.first?`${l.first.created_at_formatted||"-"}${l.count>1?` (+${l.count-1})`:""}`:"Sem engajamento detectado",q=c.first?`${c.first.created_at_formatted||"-"}${c.count>1?` (+${c.count-1})`:""}`:n?"Sem envio de formulário":"Sem clique em link",j=n&&c.first?c.first.form_has_user_data?"Dados informados":"Sem dados informados":"",be=j?`${q} • ${j}`:q,L=!!s.value?.conversion,ke=L?`${s.value?.created_at_formatted||"-"} • Convertido`:"Não convertido";return[{name:1,title:"Page View",caption:N,icon:"visibility",done:!0,color:"primary"},{name:2,title:"Page Engaged",caption:we,icon:"insights",done:!!l.first,color:l.first?"primary":"grey-6"},{name:3,title:n?"Form Submit":"Link Click",caption:be,icon:n?"fact_check":"ads_click",done:!!c.first,color:c.first?"primary":"grey-6"},{name:4,title:"Conversão",caption:ke,icon:L?"task_alt":"radio_button_unchecked",done:L,color:L?"positive":"grey-6"}]}),ce=o(()=>{const l=M.value.filter(e=>e.done);return l.length===0?1:l[l.length-1].name}),ve=o(()=>{const l=s.value?.device_category?.name,e=s.value?.device_type,i=y(l);return i!=="-"?i:y(e)}),me=o(()=>{const l=s.value?.browser?.name,e=s.value?.browser_name,i=s.value?.browser_version,n=y(e),c=y(i),N=y(l);return n!=="-"&&c!=="-"?`${n} ${c}`:n!=="-"?n:N!=="-"?N:"-"}),fe=o(()=>{const l=s.value?.os_name,e=s.value?.os_version,i=y(l),n=y(e);return i!=="-"&&n!=="-"?`${i} ${n}`:i!=="-"?i:"-"});function Q(l){if(!l)return"-";try{const e=typeof window<"u"?window.location.origin:"https://placeholder.local",i=new URL(l,e);return`${i.origin}${i.pathname}`}catch{return l.split("?")[0]??l}}function pe(l){if(!l)return null;try{const e=typeof window<"u"?window.location.origin:"https://placeholder.local";return new URL(l,e).host||null}catch{return null}}function g(l){return l!=null&&String(l).trim()!==""}function y(l){const e=String(l??"").trim();if(!e)return"-";const i=e.toLowerCase();return i==="-"||i==="unknown"||i==="desconhecido"||i==="unk"?"-":e}function _e(l){return l==null?"-":l?"Sim":"Não"}function u(l){if(l==null)return"-";if(Array.isArray(l)||typeof l=="object")try{return JSON.stringify(l)}catch{return String(l)}return String(l)}function U(l){const e=u(l);return!g(e)||e==="-"?"-":e.length<=H?e:e.slice(0,H)}function ge(){const l=s.value?.gclid;if(g(l))return String(l);const e=x.value?.query_params??{},i=Object.entries(e).find(([n])=>String(n).toLowerCase()==="gclid");return i?u(i[1]):""}function ye(l){const e=String(l||"").trim();return e?e.startsWith("click_id:")?`Clique identificado por ${e.slice(9)}`:e.startsWith("utm_medium:")?`Classificado por utm_medium=${e.slice(11)}`:e.startsWith("referrer_search:")?`Referência de buscador (${e.slice(16)})`:e.startsWith("referrer_social:")?`Referência de rede social (${e.slice(16)})`:e.startsWith("referrer:")?`Referência externa (${e.slice(9)})`:e==="internal_referrer"?"Navegação interna no mesmo domínio":e.startsWith("utm_source_only:")?`Somente utm_source informado (${e.slice(16)})`:e==="no_referrer_no_utm_no_click_id"?"Sem referrer, UTM ou click-id (direto)":e:"-"}async function b(l){const e=u(l);try{await navigator.clipboard.writeText(e),D.notify({type:"positive",message:"Valor copiado."})}catch{D.notify({type:"negative",message:"Nao foi possivel copiar."})}}return(l,e)=>(r(),f(Le,{modelValue:I.value,"onUpdate:modelValue":e[6]||(e[6]=i=>I.value=i),"transition-show":"scale","transition-hide":"scale"},{default:d(()=>[v(Se,{class:"pageview-detail-card"},{default:d(()=>[v(W,{class:"tw-flex tw-justify-end"},{default:d(()=>[v(w,{icon:"close",flat:"",round:"",dense:"",onClick:e[0]||(e[0]=i=>I.value=!1)})]),_:1}),P.loading?(r(),f(he,{key:0,indeterminate:"",color:"primary"})):p("",!0),P.loading?p("",!0):(r(),f(W,{key:1,class:"tw-grid tw-gap-6 tw-grid-cols-1 xl:tw-grid-cols-2"},{default:d(()=>[t("section",De,[t("div",Ie,[e[20]||(e[20]=t("div",{class:"section-card__header"},"VISITA",-1)),t("div",xe,[t("div",ze,[t("div",null,[e[7]||(e[7]=t("div",{class:"detail-label"},"Data/Horário",-1)),t("div",Ee,a(s.value.created_at_formatted),1)]),t("div",null,[e[8]||(e[8]=t("div",{class:"detail-label"},"Campanha",-1)),t("div",Oe,a(Y.value),1)]),t("div",null,[e[10]||(e[10]=t("div",{class:"detail-label"},"IP",-1)),t("div",Be,[t("div",Te,a(s.value.ip||"-"),1),g(s.value.ip)?(r(),f(w,{key:0,dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:e[1]||(e[1]=i=>b(s.value.ip))},{default:d(()=>[v(k,null,{default:d(()=>[...e[9]||(e[9]=[C("Copiar IP",-1)])]),_:1})]),_:1})):p("",!0)])]),t("div",null,[e[12]||(e[12]=t("div",{class:"detail-label"},"GCLID",-1)),t("div",Ue,[t("div",Ae,a(U(O.value)),1),g(O.value)?(r(),f(w,{key:0,dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:e[2]||(e[2]=i=>b(O.value))},{default:d(()=>[v(k,null,{default:d(()=>[...e[11]||(e[11]=[C("Copiar GCLID",-1)])]),_:1})]),_:1})):p("",!0)])]),t("div",null,[e[14]||(e[14]=t("div",{class:"detail-label"},"Id de acompanhamento",-1)),t("div",Fe,[t("div",Ge,a(U(B.value)),1),g(B.value)?(r(),f(w,{key:0,dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:e[3]||(e[3]=i=>b(B.value))},{default:d(()=>[v(k,null,{default:d(()=>[...e[13]||(e[13]=[C("Copiar código composto",-1)])]),_:1})]),_:1})):p("",!0)])]),t("div",null,[e[15]||(e[15]=t("div",{class:"detail-label"},"Canal",-1)),t("div",Me,a(A.value),1)])]),e[17]||(e[17]=t("div",{class:"subsection-separator"},null,-1)),v($e,{flat:"",animated:"","alternative-labels":"",class:"visit-flow-stepper",vertical:Ve(D).screen.lt.lg,"model-value":ce.value},{default:d(()=>[(r(!0),_(R,null,V(M.value,i=>(r(),f(Ne,{key:i.name,name:i.name,title:i.title,caption:i.caption,icon:i.icon,done:i.done,color:i.color},null,8,["name","title","caption","icon","done","color"]))),128))]),_:1},8,["vertical","model-value"]),e[18]||(e[18]=t("div",{class:"subsection-separator"},null,-1)),e[19]||(e[19]=t("div",{class:"subsection-title"},"GEOLOCALIZAÇÃO",-1)),t("div",Qe,[t("div",null,[e[16]||(e[16]=t("div",{class:"detail-label"},"País",-1)),t("div",qe,[F.value?(r(),_("img",{key:0,src:F.value,alt:h.value.country_code,class:"tw-w-6 tw-h-4 tw-rounded-sm tw-object-cover tw-border tw-border-gray-200"},null,8,je)):p("",!0),t("span",null,a(h.value.country_name??"-"),1)])]),(r(),_(R,null,V(K,i=>t("div",{key:i.key},[t("div",We,a(i.label),1),t("div",He,a(h.value[i.key]??"-"),1)])),64))])])])]),t("section",Je,[t("div",Ke,[e[37]||(e[37]=t("div",{class:"section-card__header"},"DISPOSITIVO, NAVEGADOR & REDE",-1)),t("div",Ze,[t("div",Xe,[t("div",null,[e[21]||(e[21]=t("div",{class:"detail-label"},"Categoria",-1)),t("div",Ye,a(ve.value),1)]),t("div",null,[e[22]||(e[22]=t("div",{class:"detail-label"},"Marca",-1)),t("div",et,a(u(s.value.device_brand)),1)]),t("div",null,[e[23]||(e[23]=t("div",{class:"detail-label"},"Modelo",-1)),t("div",tt,a(u(s.value.device_model)),1)]),t("div",null,[e[24]||(e[24]=t("div",{class:"detail-label"},"Sistema Operacional",-1)),t("div",lt,a(fe.value),1)]),t("div",null,[e[25]||(e[25]=t("div",{class:"detail-label"},"Navegador",-1)),t("div",it,a(me.value),1)]),t("div",null,[e[26]||(e[26]=t("div",{class:"detail-label"},"Idioma",-1)),t("div",at,a(u(s.value.language)),1)]),t("div",null,[e[27]||(e[27]=t("div",{class:"detail-label"},"Plataforma",-1)),t("div",ot,a(u(s.value.platform)),1)]),t("div",null,[e[28]||(e[28]=t("div",{class:"detail-label"},"Tela",-1)),t("div",st,a(u(s.value.screen_width))+" x "+a(u(s.value.screen_height)),1)]),t("div",null,[e[29]||(e[29]=t("div",{class:"detail-label"},"Viewport",-1)),t("div",nt,a(u(s.value.viewport_width))+" x "+a(u(s.value.viewport_height)),1)]),t("div",null,[e[30]||(e[30]=t("div",{class:"detail-label"},"DPR",-1)),t("div",rt,a(u(s.value.device_pixel_ratio)),1)])]),e[35]||(e[35]=t("div",{class:"subsection-separator"},null,-1)),e[36]||(e[36]=t("div",{class:"subsection-title"},"INFORMAÇÕES DA REDE",-1)),t("div",dt,[t("div",null,[e[31]||(e[31]=t("div",{class:"detail-label"},"ISP",-1)),t("div",ut,a(S.value.isp||"-"),1)]),t("div",null,[e[32]||(e[32]=t("div",{class:"detail-label"},"Organização",-1)),t("div",ct,a(S.value.organization||"-"),1)]),t("div",null,[e[33]||(e[33]=t("div",{class:"detail-label"},"Categoria IP (Lookup)",-1)),t("div",vt,[t("div",{class:"ip-category-label",style:Pe({color:te.value})},a(le.value),5),t("div",mt,a(ie.value),1)])]),t("div",null,[e[34]||(e[34]=t("div",{class:"detail-label"},"Fraud Score",-1)),t("div",ft,a(S.value.fraud_score??"-"),1)])]),t("div",pt,[(r(),_(R,null,V(Z,i=>t("div",{key:i.key},[t("div",_t,a(i.label),1),t("div",gt,a(_e(ee.value[i.key])),1)])),64))])])])]),t("section",yt,[t("div",wt,[e[47]||(e[47]=t("div",{class:"section-card__header"},"ORIGEM DO TRÁFEGO",-1)),t("div",bt,[t("div",kt,[t("div",null,[e[38]||(e[38]=t("div",{class:"detail-label"},"Canal",-1)),t("div",Ct,a(A.value),1)]),t("div",null,[e[39]||(e[39]=t("div",{class:"detail-label"},"Motivo da classificação",-1)),t("div",St,a(oe.value),1)]),t("div",null,[e[40]||(e[40]=t("div",{class:"detail-label"},"Domínio de referrer",-1)),t("div",ht,a(re.value||"-"),1)]),t("div",null,[e[42]||(e[42]=t("div",{class:"detail-label"},"Referrer completo",-1)),t("div",$t,[t("div",Nt,a($.value||"-"),1),g($.value)?(r(),f(w,{key:0,dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:e[4]||(e[4]=i=>b($.value))},{default:d(()=>[v(k,null,{default:d(()=>[...e[41]||(e[41]=[C("Copiar referrer",-1)])]),_:1})]),_:1})):p("",!0)])]),t("div",Lt,[e[44]||(e[44]=t("div",{class:"detail-label"},"Landing page (sem parâmetros)",-1)),t("div",Rt,[t("div",Vt,a(ne.value),1),g(E.value)?(r(),f(w,{key:0,dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:e[5]||(e[5]=i=>b(E.value))},{default:d(()=>[v(k,null,{default:d(()=>[...e[43]||(e[43]=[C("Copiar landing URL",-1)])]),_:1})]),_:1})):p("",!0)])]),t("div",Pt,[e[45]||(e[45]=t("div",{class:"detail-label"},"Página atual (sem parâmetros)",-1)),t("div",Dt,a(se.value),1)]),t("div",It,[e[46]||(e[46]=t("div",{class:"detail-label"},"Parâmetros da URL",-1)),ue.value?(r(),_("div",xt,[(r(!0),_(R,null,V(G.value,([i,n])=>(r(),_("div",{key:`query-${i}-${n}`,class:"url-param-chip"},[t("div",zt,a(i),1),t("div",Et,[t("div",Ot,a(U(n)),1),v(w,{dense:"",flat:"",round:"",size:"sm",icon:"content_copy",onClick:c=>b(n)},{default:d(()=>[v(k,null,{default:d(()=>[C("Copiar "+a(i),1)]),_:2},1024)]),_:2},1032,["onClick"])])]))),128))])):(r(),_("div",Bt,"-"))])])])])])]),_:1}))]),_:1})]),_:1},8,["modelValue"]))}},Gt=Re(Tt,[["__scopeId","data-v-2bc376c7"]]);export{Gt as default};
