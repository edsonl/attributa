import{x as V,C as m,h as u,E as U,r as D,s as b,F as x,i as C,t as T,v as B,N as y}from"./vendor-quasar-C0NOBKaR.js";import{f as E,_ as F,r as c,G as _,H as w,Q as g,E as a,C as j,L as k,u as l,S as q,$ as P,D as r,j as h,N as G,I,V as L}from"./vendor-CkK7ip2Q.js";const $={class:"tw-flex tw-justify-end tw-gap-2"},H={key:0,class:"tw-text-center tw-py-6"},R={__name:"FormCampaign",props:{campaign:{type:Object,default:null},channels:{type:Array,required:!0},countries:{type:Array,required:!0},affiliate_platforms:{type:Array,required:!0},googleAdsAccounts:{type:Array,required:!0}},setup(i){const n=i,A=E(()=>!!n.campaign),t=F({name:n.campaign?.name??"",pixel_code:n.campaign?.pixel_code??"",status:n.campaign?.status??!0,channel_id:n.campaign?.channel_id??null,affiliate_platform_id:n.campaign?.affiliate_platform_id??null,google_ads_account_id:n.campaign?.google_ads_account_id??null,countries:n.campaign?.countries?n.campaign.countries.map(s=>s.id):[],commission_value:n.campaign?.commission_value??null});function S(){A.value?t.put(route("panel.campaigns.update",n.campaign.id)):t.post(route("panel.campaigns.store"))}const f=c(!1),v=c(!1),d=c(""),p=c(null);async function Q(){if(n.campaign?.id){f.value=!0,v.value=!0,d.value="";try{const s=await L.get(route("panel.campaigns.tracking_code",n.campaign.id));d.value=String(s.data.script||"").trim()}catch{y.create({type:"negative",message:"Não foi possível carregar o código de acompanhamento",position:"top-right"})}finally{v.value=!1}}}function N(){if(p.value){p.value.focus(),p.value.select();try{if(!document.execCommand("copy"))throw new Error;y.create({type:"positive",message:"Código copiado",timeout:2e3,position:"top-right"})}catch{y.create({type:"negative",message:"Não foi possível copiar o código",timeout:3e3,position:"top-right"})}}}return(s,e)=>(w(),_(I,null,[g("form",{onSubmit:P(S,["prevent"]),class:"tw-space-y-6"},[a(V,{modelValue:l(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).name=o),label:"Nome da campanha",outlined:"",dense:""},null,8,["modelValue"]),a(m,{modelValue:l(t).channel_id,"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).channel_id=o),options:i.channels,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"Canal",outlined:"",dense:""},null,8,["modelValue","options"]),a(m,{modelValue:l(t).affiliate_platform_id,"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).affiliate_platform_id=o),options:i.affiliate_platforms,"option-label":"name","option-value":"id","emit-value":"","map-options":"",label:"Plataforma de Afiliado",outlined:"",dense:""},null,8,["modelValue","options"]),a(m,{label:"Regiões de segmentação (países)",modelValue:l(t).countries,"onUpdate:modelValue":e[3]||(e[3]=o=>l(t).countries=o),options:i.countries,"option-label":"name","option-value":"id","emit-value":"","map-options":"",multiple:"","use-chips":"","use-input":"",outlined:"",dense:""},null,8,["modelValue","options"]),a(m,{modelValue:l(t).google_ads_account_id,"onUpdate:modelValue":e[4]||(e[4]=o=>l(t).google_ads_account_id=o),options:i.googleAdsAccounts,"option-value":"id","option-label":"label","emit-value":"","map-options":"",clearable:"",label:"Conta de Anúncios",hint:"Selecione a conta do Google Ads desta campanha"},null,8,["modelValue","options"]),a(V,{modelValue:l(t).pixel_code,"onUpdate:modelValue":e[5]||(e[5]=o=>l(t).pixel_code=o),label:"Pixel de acompanhamento",outlined:"",dense:""},null,8,["modelValue"]),i.campaign?(w(),j(u,{key:0,flat:"",icon:"code",color:"primary",label:"Ver código de acompanhamento",onClick:Q})):k("",!0),a(U,{modelValue:l(t).status,"onUpdate:modelValue":e[6]||(e[6]=o=>l(t).status=o),label:"Campanha ativa"},null,8,["modelValue"]),g("div",$,[a(u,{flat:"",label:"Cancelar",onClick:e[7]||(e[7]=o=>l(q).visit(s.route("panel.campaigns.index")))}),a(u,{color:"primary",label:"Salvar",type:"submit"})])],32),a(B,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=o=>f.value=o)},{default:r(()=>[a(D,{style:{"min-width":"720px","max-width":"95vw","min-height":"450px"}},{default:r(()=>[a(b,{class:"tw-flex tw-justify-between tw-items-center"},{default:r(()=>[e[9]||(e[9]=g("div",{class:"tw-text-lg tw-font-semibold"}," Código de acompanhamento ",-1)),h(a(u,{flat:"",dense:"",icon:"close"},null,512),[[x]])]),_:1}),a(C),a(b,null,{default:r(()=>[v.value?(w(),_("div",H," Carregando... ")):k("",!0),g("textarea",{ref_key:"trackingTextarea",ref:p,class:"tw-w-full tw-h-72 tw-font-mono tw-text-sm tw-p-3 tw-bg-gray-100 tw-rounded",readonly:""},G(d.value),513)]),_:1}),a(C),a(T,{align:"right"},{default:r(()=>[a(u,{flat:"",icon:"content_copy",label:"Copiar",disable:!d.value,onClick:N},null,8,["disable"]),h(a(u,{color:"primary",label:"Fechar"},null,512),[[x]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{R as default};
