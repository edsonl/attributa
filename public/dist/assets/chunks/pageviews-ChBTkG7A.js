import{C as x,A as R,B as p,h as D,k as b,r as N}from"./vendor-quasar-CLzIisyG.js";import{r,w as Q,e as V,G as E,H as g,E as o,u as S,P as L,D as n,Q as _,C as y,M as T,N as U,I as q,V as m}from"./vendor-D8nj3W7R.js";const A={class:"row q-mb-md items-center"},F={class:"col-12 col-md-4"},j={__name:"Pageviews",setup(I){const f=r([]),s=r(!1),h=r(null),l=r({page:1,rowsPerPage:20,rowsNumber:0,sortBy:"created_at",descending:!0}),d=r(null),v=r([]),C=[{name:"created_at",label:"Data",field:"created_at",sortable:!0,align:"left"},{name:"campaign_name",label:"Campanha",field:"campaign_name",sortable:!0,align:"left"},{name:"campaign_code",label:"Cód/Campanha",field:"campaign_code",sortable:!0,align:"left"},{name:"url",label:"URL",field:"url",sortable:!0,align:"left"},{name:"ip",label:"IP",field:"ip",sortable:!0,align:"left"},{name:"conversion",label:"Conversão",field:"conversion",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function k(a){return a?new Date(a).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"medium"}):"-"}function B(){m.get(route("panel.atividade.campaigns")).then(a=>{v.value=a.data})}function u(a){s.value=!0;const{page:t,rowsPerPage:e,sortBy:i,descending:w}=a.pagination;return m.get(route("panel.atividade.pageviews.data"),{params:{page:t,per_page:e,sortBy:i,descending:w,campaign_code:d.value}}).then(c=>{f.value=c.data.data,l.value={...l.value,page:c.data.current_page,rowsPerPage:c.data.per_page,rowsNumber:c.data.total,sortBy:i,descending:w}}).finally(()=>{s.value=!1})}async function P(a){if(!a)return;let t=!0;const e=typeof window<"u",i=e?window.$confirm:null;if(i?t=await i({title:"Excluir pageview",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):e&&(t=window.confirm("Excluir este pageview?")),!!t){s.value=!0;try{await m.delete(route("panel.atividade.pageviews.destroy",a)),await u({pagination:l.value})}finally{s.value=!1}}}return Q(d,()=>{l.value.page=1,u({pagination:l.value})}),V(()=>{B(),u({pagination:l.value})}),(a,t)=>(g(),E(q,null,[o(S(L),{title:"Relatório de atividade"}),o(N,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:n(()=>[_("div",A,[_("div",F,[o(x,{ref_key:"tableRef",ref:h,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),options:v.value,"option-label":"name","option-value":"code","emit-value":"","map-options":"",clearable:"",label:"Filtrar por campanha"},null,8,["modelValue","options"])])]),o(R,{rows:f.value,columns:C,"row-key":"id",loading:s.value,pagination:l.value,"onUpdate:pagination":t[1]||(t[1]=e=>l.value=e),"binary-state-sort":!0,onRequest:u},{"body-cell-created_at":n(e=>[o(p,{props:e},{default:n(()=>[T(U(k(e.value)),1)]),_:2},1032,["props"])]),"body-cell-conversion":n(e=>[o(p,{props:e},{default:n(()=>[e.value==="1"?(g(),y(b,{key:0,color:"green",label:"Convertido"})):(g(),y(b,{key:1,color:"grey-4","text-color":"dark",label:"Não convertido"}))]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[o(p,{props:e,class:"tw-text-right"},{default:n(()=>[o(D,{dense:"",flat:"",icon:"delete",color:"negative",onClick:i=>P(e.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})],64))}};export{j as default};
