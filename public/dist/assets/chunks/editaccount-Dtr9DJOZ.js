import{w as E,l as z,B as D,A as w,c as u,C as F,E as N,e as M,v as O}from"./vendor-quasar-Bee0Lbku.js";import{B as j,f as Q,$ as L,r as k,w as R,G as p,H as m,E as l,Q as o,u as n,S as G,D as d,a0 as H,I as B,J as q,C as J,O as P}from"./vendor-BB0I-wvh.js";import{A as T}from"../app-E_Yf9P2s.js";const K={class:"tw-max-w-xl tw-mx-auto tw-mt-6"},W={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},X={class:"tw-border tw-border-slate-200 tw-rounded-lg tw-p-3 tw-space-y-3"},Y={key:0,class:"tw-text-sm tw-text-slate-500"},Z={key:1,class:"tw-space-y-3"},ee={class:"tw-px-3 tw-pb-3 tw-space-y-2"},ae={class:"tw-text-sm tw-font-medium"},te={class:"tw-text-xs tw-text-slate-500"},le={class:"tw-flex tw-justify-end tw-gap-3 tw-pt-2"},oe={layout:(C,c)=>C(T,{gradientPage:!0},()=>c)},ie=Object.assign(oe,{__name:"EditAccount",setup(C){const c=j(),x=c.props?.auth?.user??{},b=Q(()=>c.props?.notification_options||[]),U=Q(()=>c.props?.notification_preferences||[]),t=L({name:x.name??"",email:x.email??"",notification_email:x.notification_email??"",password:"",password_confirmation:"",notification_preferences:[]}),_=k(!1),v=k(!1),f=k({});function I(){t.notification_preferences=A(),t.put(route("account.update"),{preserveScroll:!0})}const S=r=>!!(r&&String(r).trim())||"Campo obrigatório",h=r=>/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(r)||"E-mail inválido";function $(r,e){const a={},i={};for(const s of e||[]){const g=Number(s?.notification_type_id||0);g<=0||(i[g]={enabled_in_app:!!(s.enabled_in_app??!0),enabled_email:!!(s.enabled_email??!1),enabled_push:!!(s.enabled_push??!1),frequency:s.frequency??null})}for(const s of r||[])for(const g of s?.types||[]){const V=Number(g?.id||0);V<=0||(a[V]=i[V]||{enabled_in_app:!0,enabled_email:!1,enabled_push:!1,frequency:null})}return a}function y(r){const e=Number(r||0);return e<=0?{enabled_in_app:!0,enabled_email:!1,enabled_push:!1,frequency:null}:(f.value[e]||(f.value[e]={enabled_in_app:!0,enabled_email:!1,enabled_push:!1,frequency:null}),f.value[e])}function A(){const r=[];for(const e of b.value||[])for(const a of e?.types||[]){const i=Number(a?.id||0);if(i<=0)continue;const s=f.value[i]||{enabled_in_app:!0,enabled_email:!1,enabled_push:!1,frequency:null};r.push({notification_type_id:i,enabled_in_app:!!s.enabled_in_app,enabled_email:!!s.enabled_email,enabled_push:!!s.enabled_push,frequency:s.frequency??null})}return r}return R(()=>[b.value,U.value],([r,e])=>{f.value=$(r,e)},{immediate:!0,deep:!0}),(r,e)=>(m(),p(B,null,[l(n(G),{title:"Editar conta"}),o("div",K,[l(O,{flat:"",bordered:"",class:"tw-rounded-2xl"},{default:d(()=>[l(E,null,{default:d(()=>[...e[7]||(e[7]=[o("div",{class:"tw-text-xl tw-font-semibold tw-mb-1"},"Editar conta",-1),o("div",{class:"tw-text-slate-600 dark:tw-text-slate-300"}," Atualize seus dados de perfil ",-1)])]),_:1}),l(z),l(E,null,{default:d(()=>[l(D,{onSubmit:H(I,["prevent"]),class:"tw-space-y-4"},{default:d(()=>[o("div",null,[e[8]||(e[8]=o("label",{class:"tw-block tw-text-sm tw-font-medium tw-mb-1"},"Nome",-1)),l(w,{modelValue:n(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>n(t).name=a),type:"text",dense:"",outlined:"",error:!!n(t).errors.name,"error-message":n(t).errors.name,rules:[S],placeholder:"Seu nome"},{prepend:d(()=>[l(u,{name:"person"})]),_:1},8,["modelValue","error","error-message","rules"])]),o("div",null,[e[9]||(e[9]=o("label",{class:"tw-block tw-text-sm tw-font-medium tw-mb-1"},"E-mail",-1)),l(w,{modelValue:n(t).email,"onUpdate:modelValue":e[1]||(e[1]=a=>n(t).email=a),type:"email",dense:"",outlined:"",clearable:"",autocomplete:"email",inputmode:"email",error:!!n(t).errors.email,"error-message":n(t).errors.email,rules:[S,h],placeholder:"voce@exemplo.com"},{prepend:d(()=>[l(u,{name:"mail"})]),_:1},8,["modelValue","error","error-message","rules"])]),o("div",null,[e[10]||(e[10]=o("label",{class:"tw-block tw-text-sm tw-font-medium tw-mb-1"},"E-mail para notificações",-1)),l(w,{modelValue:n(t).notification_email,"onUpdate:modelValue":e[2]||(e[2]=a=>n(t).notification_email=a),type:"email",dense:"",outlined:"",clearable:"",autocomplete:"email",inputmode:"email",error:!!n(t).errors.notification_email,"error-message":n(t).errors.notification_email,rules:[a=>!a||h(a)],placeholder:"Se vazio, usa o e-mail principal",hint:"Se vazio, usaremos o e-mail principal da conta."},{prepend:d(()=>[l(u,{name:"alternate_email"})]),_:1},8,["modelValue","error","error-message","rules"])]),o("div",W,[o("div",null,[e[11]||(e[11]=o("label",{class:"tw-block tw-text-sm tw-font-medium tw-mb-1"},"Nova senha (opcional)",-1)),l(w,{modelValue:n(t).password,"onUpdate:modelValue":e[4]||(e[4]=a=>n(t).password=a),type:_.value?"text":"password",dense:"",outlined:"",error:!!n(t).errors.password,"error-message":n(t).errors.password,placeholder:"Deixe em branco para manter"},{prepend:d(()=>[l(u,{name:"lock"})]),append:d(()=>[l(u,{name:_.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[3]||(e[3]=a=>_.value=!_.value)},null,8,["name"])]),_:1},8,["modelValue","type","error","error-message"])]),o("div",null,[e[12]||(e[12]=o("label",{class:"tw-block tw-text-sm tw-font-medium tw-mb-1"},"Confirmar nova senha",-1)),l(w,{modelValue:n(t).password_confirmation,"onUpdate:modelValue":e[6]||(e[6]=a=>n(t).password_confirmation=a),type:v.value?"text":"password",dense:"",outlined:"",placeholder:"Repita a nova senha"},{prepend:d(()=>[l(u,{name:"lock"})]),append:d(()=>[l(u,{name:v.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[5]||(e[5]=a=>v.value=!v.value)},null,8,["name"])]),_:1},8,["modelValue","type"])])]),o("div",X,[e[13]||(e[13]=o("div",{class:"tw-text-sm tw-font-semibold"},"Preferências de notificação",-1)),b.value.length?(m(),p("div",Z,[(m(!0),p(B,null,q(b.value,a=>(m(),J(F,{key:`cat-${a.id}`,label:a.name,dense:"","default-opened":"",class:"tw-border tw-border-slate-200 tw-rounded"},{default:d(()=>[o("div",ee,[(m(!0),p(B,null,q(a.types||[],i=>(m(),p("div",{key:`type-${i.id}`,class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-[1fr_auto_auto] tw-gap-2 tw-items-center tw-border-b tw-border-slate-100 tw-py-2 last:tw-border-b-0"},[o("div",null,[o("div",ae,P(i.name),1),o("div",te,P(i.slug),1)]),l(N,{modelValue:y(i.id).enabled_in_app,"onUpdate:modelValue":s=>y(i.id).enabled_in_app=s,dense:"",label:"No sistema"},null,8,["modelValue","onUpdate:modelValue"]),l(N,{modelValue:y(i.id).enabled_email,"onUpdate:modelValue":s=>y(i.id).enabled_email=s,dense:"",label:"Por e-mail"},null,8,["modelValue","onUpdate:modelValue"])]))),128))])]),_:2},1032,["label"]))),128))])):(m(),p("div",Y," Nenhum tipo de notificação ativo no catálogo. "))]),o("div",le,[l(M,{type:"submit",color:"positive",unelevated:"",class:"tw-font-semibold",loading:n(t).processing,label:"Salvar alterações"},null,8,["loading"])])]),_:1})]),_:1})]),_:1})])],64))}});export{ie as default};
