import{u as G,h as p,j as I,x as f,c as L,A as z,B as w,k as N,r as E,s as D,i as H,H as U,t as M,v as O}from"./vendor-quasar-s7YXAUFU.js";import{r as d,f as K,w as J,e as W,E as X,F as Y,C as l,O as r,u as Z,N as ee,B as s,K as ae,L as C,M as R,G as le,S as h}from"./vendor-D6jaF0sv.js";const te={class:"tw-space-y-3"},oe={class:"tw-flex tw-flex-col md:tw-flex-row tw-gap-3 tw-mb-4"},se={class:"tw-flex tw-gap-2"},re={class:"tw-flex tw-gap-2 tw-w-full md:tw-w-[360px] lg:tw-w-[420px] md:tw-ml-auto md:tw-justify-end"},ne={class:"tw-flex tw-items-center tw-gap-2"},ie={class:"text-h6"},ue={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},de={class:"tw-grid tw-grid-cols-1 md:tw-grid-cols-2 tw-gap-3"},ce={class:"tw-flex tw-items-center tw-gap-2 tw-rounded-md tw-border tw-border-gray-300 tw-px-3 tw-py-2"},me={class:"tw-flex tw-gap-6"},ve=400,we={__name:"Index",setup(ge){const B=d([]),m=d(!1),i=d({page:1,rowsPerPage:10,rowsNumber:0,sortBy:"name",descending:!1}),y=d(""),b=d(!1),c=d(!1),n=d({}),v=G();let _=null;const x=()=>({id:null,name:"",slug:"",color_hex:"#6B7280",description:"",is_system:!1,active:!0}),t=d(x()),k=K(()=>!!t.value.id),T=[{name:"name",label:"Nome",field:"name",sortable:!0,align:"left"},{name:"slug",label:"Slug",field:"slug",sortable:!0,align:"left"},{name:"color_hex",label:"Cor",field:"color_hex",sortable:!1,align:"left"},{name:"active",label:"Ativo",field:"active",sortable:!0,align:"left"},{name:"is_system",label:"Tipo",field:"is_system",sortable:!0,align:"left"},{name:"created_at",label:"Criado em",field:"created_at",sortable:!0,align:"left"},{name:"actions",label:"Ações",field:"id",align:"right"}];function P(o){return o?new Date(o).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}):"-"}function g(o){m.value=!0;const{page:a,rowsPerPage:e,sortBy:u,descending:Q}=o.pagination;return h.get(route("panel.campaign-statuses.data"),{params:{page:a,per_page:e,sortBy:u,descending:Q,search:y.value||void 0}}).then(V=>{B.value=V.data.data,i.value={...i.value,page:V.data.current_page,rowsPerPage:V.data.per_page,rowsNumber:V.data.total,sortBy:u,descending:Q}}).finally(()=>{m.value=!1})}function S(o=!1){_&&(clearTimeout(_),_=null);const a=()=>{i.value.page=1,g({pagination:i.value})};o?a():_=setTimeout(a,ve)}function A(){t.value=x(),n.value={},c.value=!0}function $(o){t.value={id:o.id,name:o.name,slug:o.slug,color_hex:o.color_hex||"#6B7280",description:o.description??"",is_system:o.is_system,active:o.active},n.value={},c.value=!0}function F(){c.value=!1,t.value=x(),n.value={}}async function j(){if(b.value)return;b.value=!0,n.value={};const o={...t.value},a=t.value.id?h.put(route("panel.campaign-statuses.update",t.value.id),o):h.post(route("panel.campaign-statuses.store"),o);try{await a,c.value=!1,t.value=x(),v.notify({type:"positive",message:"Dados salvos com sucesso!"}),await g({pagination:i.value})}catch(e){if(e.response?.status===422){n.value=e.response.data.errors||{};const u=e.response.data.message;u&&v.notify({type:"warning",message:u})}else v.notify({type:"negative",message:"Não foi possível salvar o registro."})}finally{b.value=!1}}async function q(o){if(!o?.id)return;const a=typeof window<"u"?window.$confirm:null;let e=!0;if(a?e=await a({title:"Excluir status de campanha",message:"Esta ação é permanente. Deseja realmente remover?",okLabel:"Remover",okColor:"negative"}):typeof window<"u"&&(e=window.confirm("Excluir este status de campanha?")),!!e){m.value=!0;try{await h.delete(route("panel.campaign-statuses.destroy",o.id)),v.notify({type:"positive",message:"Status removido."}),await g({pagination:i.value})}catch(u){v.notify({type:"warning",message:u?.response?.data?.message||"Falha ao remover o status."})}finally{m.value=!1}}}return J(y,()=>{S()}),W(()=>{g({pagination:i.value})}),(o,a)=>(Y(),X(le,null,[l(Z(ee),{title:"Status de Campanha"}),r("div",te,[l(E,{flat:"",bordered:"",class:"tw-rounded-2xl tw-p-4"},{default:s(()=>[r("div",oe,[r("div",se,[l(p,{color:"positive",unelevated:"",icon:"add",label:"Novo Status",onClick:A})]),l(I),r("div",re,[l(f,{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=e=>y.value=e),dense:"",outlined:"",clearable:"",placeholder:"Buscar por nome ou slug"},{append:s(()=>[l(L,{name:"search",class:"cursor-pointer",onClick:a[0]||(a[0]=e=>S(!0))})]),_:1},8,["modelValue"])])]),l(z,{rows:B.value,columns:T,"row-key":"id",loading:m.value,pagination:i.value,"onUpdate:pagination":a[2]||(a[2]=e=>i.value=e),"binary-state-sort":!0,onRequest:g},{"body-cell-color_hex":s(e=>[l(w,{props:e},{default:s(()=>[r("div",ne,[r("span",{class:"tw-inline-flex tw-h-3 tw-w-3 tw-rounded-full tw-border tw-border-black/10",style:R({backgroundColor:e.row.color_hex})},null,4),r("span",null,C(e.value),1)])]),_:2},1032,["props"])]),"body-cell-active":s(e=>[l(w,{props:e},{default:s(()=>[l(N,{color:e.row.active?"positive":"grey-6",label:e.row.active_label},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-is_system":s(e=>[l(w,{props:e},{default:s(()=>[l(N,{color:e.row.is_system?"primary":"grey-6",label:e.row.is_system_label},null,8,["color","label"])]),_:2},1032,["props"])]),"body-cell-created_at":s(e=>[l(w,{props:e},{default:s(()=>[ae(C(P(e.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":s(e=>[l(w,{props:e,class:"tw-text-right"},{default:s(()=>[l(p,{dense:"",flat:"",icon:"edit",onClick:u=>$(e.row)},null,8,["onClick"]),l(p,{dense:"",flat:"",icon:"delete",color:"negative",disable:e.row.is_system,onClick:u=>q(e.row)},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","loading","pagination"])]),_:1})]),l(O,{modelValue:c.value,"onUpdate:modelValue":a[9]||(a[9]=e=>c.value=e),persistent:""},{default:s(()=>[l(E,{class:"tw-w-full tw-max-w-2xl"},{default:s(()=>[l(D,null,{default:s(()=>[r("div",ie,C(k.value?"Editar status":"Novo status"),1)]),_:1}),l(H),l(D,{class:"tw-space-y-3"},{default:s(()=>[r("div",ue,[l(f,{modelValue:t.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.name=e),label:"Nome",dense:"",outlined:"",error:!!n.value.name,"error-message":n.value.name?.[0]},null,8,["modelValue","error","error-message"]),l(f,{modelValue:t.value.slug,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value.slug=e),label:"Slug",dense:"",outlined:"",error:!!n.value.slug,"error-message":n.value.slug?.[0]},null,8,["modelValue","error","error-message"])]),r("div",de,[l(f,{modelValue:t.value.color_hex,"onUpdate:modelValue":a[5]||(a[5]=e=>t.value.color_hex=e),label:"Cor (#RRGGBB)",dense:"",outlined:"",error:!!n.value.color_hex,"error-message":n.value.color_hex?.[0]},null,8,["modelValue","error","error-message"]),r("div",ce,[r("span",{class:"tw-inline-flex tw-h-4 tw-w-4 tw-rounded-full tw-border tw-border-black/10",style:R({backgroundColor:t.value.color_hex||"#6B7280"})},null,4),a[10]||(a[10]=r("span",{class:"tw-text-sm tw-text-gray-600"},"Preview de cor",-1))])]),l(f,{modelValue:t.value.description,"onUpdate:modelValue":a[6]||(a[6]=e=>t.value.description=e),type:"textarea",autogrow:"",label:"Descrição",dense:"",outlined:"",error:!!n.value.description,"error-message":n.value.description?.[0]},null,8,["modelValue","error","error-message"]),r("div",me,[l(U,{modelValue:t.value.active,"onUpdate:modelValue":a[7]||(a[7]=e=>t.value.active=e),label:"Status ativo"},null,8,["modelValue"]),l(U,{modelValue:t.value.is_system,"onUpdate:modelValue":a[8]||(a[8]=e=>t.value.is_system=e),label:"Status de sistema"},null,8,["modelValue"])])]),_:1}),l(M,{align:"right",class:"tw-gap-2 tw-p-4"},{default:s(()=>[l(p,{flat:"",label:"Cancelar",onClick:F}),l(p,{color:"primary",unelevated:"",loading:b.value,label:k.value?"Atualizar":"Cadastrar",onClick:j},null,8,["loading","label"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}};export{we as default};
